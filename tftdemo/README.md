# STM32F103C8 Black Pill TFT LCD Demo

A comprehensive TFT LCD & touch screen demo for the STM32F103C8 Black Pill board with SY-TFT240 display support.
The SY-TFT240 display is a clone of the more common HY-TFT240 display, which drives the 320x240 display with the ILI9325C controller, and incorporates both a touch screen and SD card slot.
These common 2.4-inch modules with touch screens almost universally integrate the XPT2046 IC for touch control. The display controller for these modules is often the ILI9320, ILI9325C, or ILI9341. The display is driven with an 8-bit parallel data bus, the SPI is used for the SD card, and the module uses a TSC2046 touch controller from Texas InstrumentsXPT, which is compatible with the XPT2046 touch controller.

The code is modified from the deliverables generated by **claude-sonnet-4-20250514** model. This project provides a full-featured graphics library with line drawing capabilities, text rendering, and geometric shape functions.

## Features

- ğŸ¨ **Full Graphics Library** - Complete drawing primitives (pixels, lines, rectangles)
- ğŸ“ **Text Rendering** - Complete 8x8 ASCII font (96 characters)
- ğŸ¯ **Parallel Interface** - 8-bit parallel communication with ILI9325C
- ğŸŒˆ **Color Support** - RGB565 format with predefined color constants
- âš¡ **Optimized Performance** - Direct GPIO register manipulation for speed
- ğŸ“Š **Demo Animations** - Multiple interactive demonstrations
- ğŸ”§ **Modular Design** - Separate driver files for easy integration

## Hardware Requirements

### Components
- STM32F103C8 Black Pill development board
- 2.4" SY-TFT240 TFT LCD display with 240x320 resolution
- Jumper wires and breadboard
- 3.3V power supply

### Pin Configuration

| Function | STM32 Pin | LCD Pin | Description |
|----------|-----------|---------|-------------|
| **Control Pins** |
| CS | PB0 | CS | Chip Select |
| RS/DC | PB1 | RS/DC | Register Select/Data Command |
| WR | PB10 | WR | Write Enable |
| RD | PB11 | RD | Read Enable (*optional*) |
| RST | PA8 | RST | Reset |
| **Data Bus (8-bit)** |
| D0-D7 | PA0-PA7 | DB0-DB7 | Parallel Data Bus |
| **Touch Screen Pins** |
| SPI2_SCK | PB13 | T_CLK | SPI2 Clock |
| SPI2_MISO | PB14 | T_DOUT | SPI2 Data Out |
| SPI2_MOSI | PB15 | T_DIN | SPI2 Data In |
| Touch CS | PA11 | T_CS | Chip Select |
| **Power** |
| VCC | 3.3V | VCC | Power Supply |
| GND | GND | GND | Ground |

## Wiring Diagram

```
STM32F103C8 Black Pill          SY-TFT240 TFT LCD
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         â”‚    â”‚                         â”‚
â”‚ PB0  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ CS                      â”‚
â”‚ PB1  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ RS/DC                   â”‚
â”‚ PB10 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ WR                      â”‚
â”‚ PB11 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ RD                      â”‚
â”‚ PA8  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ RST                     â”‚
â”‚                         â”‚    â”‚                         â”‚
â”‚ PA0  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ DB0                     â”‚
â”‚ PA1  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ DB1                     â”‚
â”‚ PA2  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ DB2                     â”‚
â”‚ PA3  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ DB3                     â”‚
â”‚ PA4  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ DB4                     â”‚
â”‚ PA5  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ DB5                     â”‚
â”‚ PA6  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ DB6                     â”‚
â”‚ PA7  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ DB7                     â”‚
â”‚                         â”‚    â”‚                         â”‚
| PA11 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ T_CS                    â”‚
| PB13 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ T_CLK                   â”‚
| PB14 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ T_DOUT                  â”‚
| PB15 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ T_DIN                   â”‚
â”‚                         â”‚    â”‚                         â”‚
â”‚ 3.3V â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ VCC                     â”‚
â”‚ GND  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ GND                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## API Reference

### Core Functions

#### Display Control
```c
void ILI9325C_Init(void);                    // Initialize the display
void ILI9325C_Clear(uint16_t color);         // Clear screen with color
```

#### Drawing Primitives
```c
void ILI9325C_DrawPixel(uint16_t x, uint16_t y, uint16_t color);
void ILI9325C_DrawLine(uint16_t x1, uint16_t y1, uint16_t x2, uint16_t y2, uint16_t color);
void ILI9325C_DrawRect(uint16_t x, uint16_t y, uint16_t width, uint16_t height, uint16_t color);
void ILI9325C_FillRect(uint16_t x, uint16_t y, uint16_t width, uint16_t height, uint16_t color);
```

#### Text Rendering
```c
void ILI9325C_DrawChar(uint16_t x, uint16_t y, char ch, uint16_t color, uint16_t bgcolor);
void ILI9325C_DrawString(uint16_t x, uint16_t y, char* str, uint16_t color, uint16_t bgcolor);
```

### Predefined Colors (RGB565)
```c
#define COLOR_BLACK     0x0000    #define COLOR_WHITE     0xFFFF
#define COLOR_RED       0xF800    #define COLOR_GREEN     0x07E0
#define COLOR_BLUE      0x001F    #define COLOR_YELLOW    0xFFE0
#define COLOR_CYAN      0x07FF    #define COLOR_MAGENTA   0xF81F
#define COLOR_GRAY      0x7BEF    #define COLOR_ORANGE    0xFD20
```

## Demos

The main application includes several demonstration modes:

### 1. Basic Lines
- Horizontal, vertical, and diagonal line patterns
- Color-coded line drawing sequences

### 2. Geometric Patterns
- Radial lines emanating from center point
- Grid overlay patterns
- Nested rectangle animations

### 3. Random Graphics
- Randomly colored line generation
- Dynamic pattern creation

### 4. Mathematical Visualization
- Animated sine wave plotting
- Real-time curve rendering

### 5. Text Display
- Font rendering demonstration
- Mixed text and graphics

## Font System

### Complete ASCII Support
The driver includes a full 8x8 bitmap font supporting:
- **Numbers**: 0-9
- **Uppercase**: A-Z
- **Lowercase**: a-z  
- **Symbols**: ! @ # $ % ^ & * ( ) - + = [ ] { } | \ : ; " ' < > ? , . / ~ `

### Font Specifications
- **Size**: 8Ã—8 pixels per character
- **Format**: Monospaced bitmap
- **Encoding**: ASCII 32-127 (96 printable characters)
- **Storage**: Optimized byte arrays in program memory

## Performance Specifications

### Display Specifications
- **Resolution**: 240Ã—320 pixels
- **Color Depth**: 16-bit RGB565 (65,536 colors)
- **Interface**: 8-bit parallel
- **Controller**: ILI9325C compatible

### System Performance
- **MCU Clock**: 72MHz (PLL from 8MHz HSE)
- **GPIO Speed**: High-speed mode for data bus
- **Drawing Speed**: ~1000 pixels/second (approximate)
- **Memory Usage**: ~2KB RAM, ~8KB Flash (excluding HAL)

## Troubleshooting

### Common Issues

#### Display Not Working
- âœ… Verify all pin connections
- âœ… Check 3.3V power supply stability
- âœ… Ensure proper ground connections
- âœ… Confirm ILI9325C controller compatibility

#### Garbled Display
- âœ… Check data bus wiring (PA0-PA7 to DB0-DB7)
- âœ… Verify control signal connections
- âœ… Test with slower GPIO speeds

#### No Text Display
- âœ… Ensure font array is properly included
- âœ… Check color contrast (foreground vs background)
- âœ… Verify character ASCII range (32-127)

#### Compilation Errors
- âœ… Enable required HAL modules
- âœ… Check include paths
- âœ… Verify STM32F1xx device selection

## Resources & References

### Documentation
- [STM32F103C8 Reference Manual](https://www.st.com/resource/en/reference_manual/rm0008-stm32f101xx-stm32f102xx-stm32f103xx-stm32f105xx-and-stm32f107xx-advanced-armbased-32bit-mcus-stmicroelectronics.pdf)
- [ILI9325C Datasheet](https://www.displayfuture.com/Display/datasheet/controller/ILI9325.pdf)
- [TSC2046 Datasheet](https://www.ti.com/lit/ds/symlink/tsc2046.pdf?ts=1763134195454&ref_url=https%253A%252F%252Fwww.google.com%252F)
- [STM32 HAL Documentation](https://www.st.com/resource/en/user_manual/um1850-description-of-stm32f1-hal-and-lowlayer-drivers-stmicroelectronics.pdf)

---

**Created with â¤ï¸ for the STM32 community**
